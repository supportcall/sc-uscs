# SC-USCS Email Gateway Setup Instructions

## Overview

The SC-USCS script generator now sends reports via HTTPS POST to your server at `https://sc-uscs.com/sendmail.php` instead of using direct SMTP from client machines. This provides:

- **100% self-hosted solution** - All credentials stay on your server
- **Better security** - No SMTP credentials exposed in batch scripts
- **Universal compatibility** - Works from any Windows computer worldwide
- **Centralized control** - Update email settings without regenerating scripts

## Installation Steps

### 1. Download the PHP File

The `sendmail.php` file is located in your project's `public/` folder. You can:
- Download it directly from your Lovable project files
- Access it at: `https://[your-lovable-url]/sendmail.php`
- Copy it from your deployed site

### 2. Configure SMTP Settings

Edit `sendmail.php` and update these lines with your SMTP server details:

```php
// SMTP Server Configuration
define('SMTP_HOST', 'smtp.gmail.com');                 // Gmail SMTP server
define('SMTP_PORT', 465);                              // SMTP port (465 for SSL)
define('SMTP_SECURE', 'ssl');                          // SSL encryption
define('SMTP_USERNAME', 'scmyhelp@gmail.com');         // Gmail username
define('SMTP_PASSWORD', 'bbvheyppvtponcdu');           // Gmail app password

// Email Configuration
define('FROM_EMAIL', 'noreply@sc-uscs.com');           // From address
define('FROM_NAME', 'SC-USCS Automated Reports');      // From name
define('TO_EMAILS', 'alerts@supportcall.com.au,alerts@supportcall.co.za,scmyhelp@gmail.com'); // Recipients
```

### 3. Upload to Your Server

Upload `sendmail.php` to your `sc-uscs.com` server:

```
üìÅ Your Server Root
‚îî‚îÄ‚îÄ sendmail.php  ‚Üê Upload here (accessible at https://sc-uscs.com/sendmail.php)
```

**Common upload locations:**
- cPanel: `public_html/sendmail.php`
- Apache: `/var/www/html/sendmail.php`
- Nginx: `/usr/share/nginx/html/sendmail.php`

### 4. Set File Permissions

Ensure the PHP file is executable:

```bash
chmod 644 sendmail.php
```

### 5. Test the Setup

Visit `https://sc-uscs.com/sendmail.php` in your browser. You should see a JSON error message (this is normal - it only accepts POST requests):

```json
{
  "success": false,
  "error": "Method not allowed. Use POST.",
  "timestamp": "2025-01-15 10:30:45"
}
```

This confirms the PHP file is working!

## How It Works

1. **User visits sc-uscs.com** ‚Üí generates custom batch script
2. **User downloads and runs script** ‚Üí performs Windows cleanup/security tasks
3. **Script collects report data** ‚Üí computer name, threats found, functions executed
4. **Script sends HTTPS POST** ‚Üí to `https://sc-uscs.com/sendmail.php` with report data
5. **PHP script receives data** ‚Üí formats beautiful HTML email
6. **PHP sends via SMTP** ‚Üí to your configured email addresses
7. **You receive report** ‚Üí in your inbox within seconds

## Server Requirements

- PHP 7.0 or higher
- `mail()` function enabled OR PHPMailer installed
- Outbound SMTP connections allowed (port 465/587)
- HTTPS enabled on sc-uscs.com (recommended)

## Troubleshooting

### Email not sending?

Check your server's PHP configuration:

```bash
# Check if mail() is enabled
php -i | grep mail

# Test mail configuration
php -r "mail('test@example.com', 'Test', 'Test message');"
```

### Want more reliable SMTP?

The `sendmail.php` file includes commented code for using PHPMailer (more reliable):

1. Download PHPMailer: https://github.com/PHPMailer/PHPMailer
2. Extract to `/lib/PHPMailer/` on your server
3. Uncomment the PHPMailer code at the bottom of `sendmail.php`

### Enable debug logging

Set `DEBUG_MODE` to `true` in `sendmail.php`:

```php
define('DEBUG_MODE', true);
```

This creates a `sendmail.log` file with all requests.

## Security Recommendations

1. **Rate Limiting**: Add rate limiting to prevent abuse (via `.htaccess` or server config)
2. **IP Whitelist**: Optionally restrict to known IP ranges
3. **HTTPS Only**: Always use HTTPS to encrypt data in transit
4. **Regular Updates**: Keep PHP and server software updated

## Support

If you need help:
- Website: supportcall.com.au
- Email: alerts@supportcall.co.za
- Email: scmyhelp@gmail.com

---

**Generated by SC-USCS v5.83 - Professional Edition**
